<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>RedisCacheStore | @stephen-shopopop/cache</title><meta name="description" content="Documentation for @stephen-shopopop/cache"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">@stephen-shopopop/cache</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="" aria-current="page">RedisCacheStore</a></li></ul><h1>Class RedisCacheStore&lt;Metadata&gt;</h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><p>A Redis-backed cache store with optional local tracking and metadata support.</p>
<p><code>RedisCacheStore</code> provides a high-level interface for storing, retrieving, and deleting
cache entries in Redis, with support for per-entry metadata, maximum entry size enforcement,
and optional local in-memory tracking for improved performance and cache invalidation.</p>
<h2 id="key-features" class="tsd-anchor-link">Key Features<a href="#key-features" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Dual Storage Architecture</strong>: Stores values and associated metadata in Redis using separate keys for data and metadata</li>
<li><strong>Size Enforcement</strong>: Enforces a configurable maximum entry size to prevent memory issues</li>
<li><strong>Local Tracking Cache</strong>: Optional local in-memory cache for fast lookups with Redis keyspace notifications for invalidation</li>
<li><strong>Automatic Cleanup</strong>: Handles automatic cleanup of stale or corrupted cache entries</li>
<li><strong>Error Resilience</strong>: Provides custom error handling via configurable error callback</li>
<li><strong>Atomic Operations</strong>: Uses Redis pipelines for atomic set operations</li>
<li><strong>TTL Support</strong>: Full support for time-to-live on cache entries</li>
</ul>
<h2 id="architecture-details" class="tsd-anchor-link">Architecture Details<a href="#architecture-details" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The store uses a two-key approach in Redis:</p>
<ol>
<li><code>metadata:[key]</code> - Hash containing JSON metadata and a UUID</li>
<li><code>values:[uuid]</code> - String containing the actual cached value</li>
</ol>
<p>This design allows for efficient metadata queries without loading large values,
and enables atomic cleanup of both parts when entries expire.</p>
<h2 id="performance-characteristics" class="tsd-anchor-link">Performance Characteristics<a href="#performance-characteristics" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Cold reads</strong>: Single Redis roundtrip (HGETALL + GET)</li>
<li><strong>Warm reads</strong>: Zero Redis roundtrips (served from tracking cache)</li>
<li><strong>Writes</strong>: Single pipelined Redis transaction (HSET + SET + 2x EXPIRE)</li>
<li><strong>Memory overhead</strong>: Minimal for metadata, configurable tracking cache size</li>
</ul>
</div><div class="tsd-comment tsd-typography"><div class="tsd-tag-since"><h4 class="tsd-anchor-link" id="since">Since<a href="#since" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>1.0.0</p>
</div></div></section><section class="tsd-panel"><h4>Type Parameters</h4><ul class="tsd-type-parameter-list"><li><span id="metadata"><span class="tsd-kind-type-parameter">Metadata</span> <span class="tsd-signature-keyword">extends</span> <span class="tsd-signature-type">object</span> = <span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">PropertyKey</span><span class="tsd-signature-symbol">,</span> <span class="tsd-signature-type">unknown</span><span class="tsd-signature-symbol">&gt;</span></span><div class="tsd-comment tsd-typography"><p>The shape of the metadata object associated with each cache entry</p>
</div></li></ul></section><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/stephen-shopopop/node-cache/blob/b8bbbce1d1b1db882a4ac86917d237c40b63daef/src/library/redis-cache-store.ts#L216">redis-cache-store.ts:216</a></li></ul></aside><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><details class="tsd-index-content tsd-accordion" open><summary class="tsd-accordion-summary tsd-index-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h5 class="tsd-index-heading uppercase">Index</h5></summary><div class="tsd-accordion-details"><section class="tsd-index-section"><h3 class="tsd-index-heading">Constructors</h3><div class="tsd-index-list"><a href="#constructor" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Methods</h3><div class="tsd-index-list"><a href="#close" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>close</span></a>
<a href="#delete" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>delete</span></a>
<a href="#findbykey" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>find<wbr/>By<wbr/>Key</span></a>
<a href="#get" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get</span></a>
<a href="#set" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>set</span></a>
</div></section></div></details></section></section><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Constructors"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Constructors</h2></summary><section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="constructor"><span>constructor</span><a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="constructorrediscachestore"><span class="tsd-signature-keyword">new</span> <span class="tsd-kind-constructor-signature">RedisCacheStore</span><span class="tsd-signature-symbol">&lt;</span><a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a> <span class="tsd-signature-keyword">extends</span> <span class="tsd-signature-type">object</span> <span class="tsd-signature-symbol">=</span> <span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">PropertyKey</span><span class="tsd-signature-symbol">,</span> <span class="tsd-signature-type">unknown</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span><br/>    <span class="tsd-kind-parameter">options</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Readonly</span><span class="tsd-signature-symbol">&lt;</span><a href="../interfaces/RedisCacheStoreOptions.html" class="tsd-signature-type tsd-kind-interface">RedisCacheStoreOptions</a><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">,</span><br/><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <a href="" class="tsd-signature-type tsd-kind-class">RedisCacheStore</a><span class="tsd-signature-symbol">&lt;</span><a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol">&gt;</span><a href="#constructorrediscachestore" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Creates a new instance of the RedisCacheStore.</p>
</div><section class="tsd-panel"><h4>Type Parameters</h4><ul class="tsd-type-parameter-list"><li><span id="constructorrediscachestoremetadata"><span class="tsd-kind-type-parameter">Metadata</span> <span class="tsd-signature-keyword">extends</span> <span class="tsd-signature-type">object</span> = <span class="tsd-signature-type">Record</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">PropertyKey</span><span class="tsd-signature-symbol">,</span> <span class="tsd-signature-type">unknown</span><span class="tsd-signature-symbol">&gt;</span></span></li></ul></section><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">options</span>: <span class="tsd-signature-type">Readonly</span><span class="tsd-signature-symbol">&lt;</span><a href="../interfaces/RedisCacheStoreOptions.html" class="tsd-signature-type tsd-kind-interface">RedisCacheStoreOptions</a><span class="tsd-signature-symbol">&gt;</span></span><div class="tsd-comment tsd-typography"><p>The configuration options for the RedisCacheStore</p>
</div><ul class="tsd-parameters"><li class="tsd-parameter"><h5><span>maxEntrySize</span></h5><div class="tsd-comment tsd-typography"><p>The maximum size (in bytes) allowed for a single cache entry. Must be a non-negative integer. Defaults to 100MB</p>
</div></li><li class="tsd-parameter"><h5><span>errorCallback</span></h5><div class="tsd-comment tsd-typography"><p>A callback function to handle errors that occur during Redis operations</p>
</div></li><li class="tsd-parameter"><h5><span>clientOpts</span></h5><div class="tsd-comment tsd-typography"><p>Options to configure the underlying Redis client. May include <code>keyPrefix</code> and other Redis client options</p>
</div></li><li class="tsd-parameter"><h5><span>clientOpts.keyPrefix</span></h5><div class="tsd-comment tsd-typography"><p>Prefix to apply to all Redis keys for namespacing</p>
</div></li><li class="tsd-parameter"><h5><span>maxCount</span></h5><div class="tsd-comment tsd-typography"><p>The maximum number of entries allowed in the tracking cache (only used when tracking is enabled)</p>
</div></li><li class="tsd-parameter"><h5><span>tracking</span></h5><div class="tsd-comment tsd-typography"><p>If set to <code>false</code>, disables the local tracking cache. Defaults to <code>true</code></p>
</div></li></ul></li></ul></div><h4 class="tsd-returns-title">Returns <a href="" class="tsd-signature-type tsd-kind-class">RedisCacheStore</a><span class="tsd-signature-symbol">&lt;</span><a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws">Throws<a href="#throws" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If <code>options</code> is not an object</p>
</div><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-1">Throws<a href="#throws-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If <code>maxEntrySize</code> is not a non-negative integer</p>
</div><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-2">Throws<a href="#throws-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If <code>errorCallback</code> is not a function</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-basic-initialization">Example: Basic initialization<a href="#example-basic-initialization" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">store</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">RedisCacheStore</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">clientOpts:</span><span class="hl-1"> { </span><span class="hl-4">host:</span><span class="hl-1"> </span><span class="hl-2">&#39;localhost&#39;</span><span class="hl-1">, </span><span class="hl-4">port:</span><span class="hl-1"> </span><span class="hl-8">6379</span><span class="hl-1"> }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-advanced-configuration">Example: Advanced configuration<a href="#example-advanced-configuration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">store</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">RedisCacheStore</span><span class="hl-1">&lt;</span><span class="hl-7">MyMetadata</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">  </span><span class="hl-4">maxEntrySize:</span><span class="hl-1"> </span><span class="hl-8">50</span><span class="hl-1"> * </span><span class="hl-8">1024</span><span class="hl-1"> * </span><span class="hl-8">1024</span><span class="hl-1">, </span><span class="hl-9">// 50MB</span><br/><span class="hl-1">  </span><span class="hl-4">maxCount:</span><span class="hl-1"> </span><span class="hl-8">5000</span><span class="hl-1">,                  </span><span class="hl-9">// Track up to 5000 entries locally</span><br/><span class="hl-1">  </span><span class="hl-4">tracking:</span><span class="hl-1"> </span><span class="hl-5">true</span><span class="hl-1">,                  </span><span class="hl-9">// Enable local tracking (default)</span><br/><span class="hl-1">  </span><span class="hl-4">clientOpts:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">host:</span><span class="hl-1"> </span><span class="hl-2">&#39;redis.example.com&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">port:</span><span class="hl-1"> </span><span class="hl-8">6380</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">keyPrefix:</span><span class="hl-1"> </span><span class="hl-2">&#39;myapp:&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">retryDelayOnFailover:</span><span class="hl-1"> </span><span class="hl-8">100</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">errorCallback</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">logger</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&#39;Redis cache error:&#39;</span><span class="hl-1">, </span><span class="hl-4">err</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">metrics</span><span class="hl-1">.</span><span class="hl-0">increment</span><span class="hl-1">(</span><span class="hl-2">&#39;redis.errors&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/stephen-shopopop/node-cache/blob/b8bbbce1d1b1db882a4ac86917d237c40b63daef/src/library/redis-cache-store.ts#L317">redis-cache-store.ts:317</a></li></ul></aside></div></li></ul></section></section></details><details class="tsd-panel-group tsd-member-group tsd-accordion" open><summary class="tsd-accordion-summary" data-key="section-Methods"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h2>Methods</h2></summary><section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="close"><span>close</span><a href="#close" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="close-1"><span class="tsd-kind-call-signature">close</span><span class="tsd-signature-symbol">()</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span><a href="#close-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Closes the Redis connections used by the cache store.</p>
<p>This method ensures graceful shutdown by:</p>
<ol>
<li>Setting the closed flag to prevent further operations</li>
<li>Calling <code>quit()</code> on all Redis clients (main and subscriber)</li>
<li>Waiting for all connections to close properly</li>
<li>Handling any errors during the closing process</li>
</ol>
<p>Once closed, the store instance should not be used for further operations.
It's recommended to call this method when your application shuts down
or when you're done with the cache store to prevent connection leaks.</p>
</div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves when all connections are closed</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-graceful-shutdown">Example: Graceful shutdown<a href="#example-graceful-shutdown" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-4">process</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;SIGTERM&#39;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Shutting down gracefully...&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Cache store closed&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">process</span><span class="hl-1">.</span><span class="hl-0">exit</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-in-a-web-server">Example: In a web server<a href="#example-in-a-web-server" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">server</span><span class="hl-1"> = </span><span class="hl-0">express</span><span class="hl-1">();</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">store</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">RedisCacheStore</span><span class="hl-1">(</span><span class="hl-4">options</span><span class="hl-1">);</span><br/><br/><span class="hl-9">// ... use store in routes ...</span><br/><br/><span class="hl-4">server</span><span class="hl-1">.</span><span class="hl-0">listen</span><span class="hl-1">(</span><span class="hl-8">3000</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Server started&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">process</span><span class="hl-1">.</span><span class="hl-0">on</span><span class="hl-1">(</span><span class="hl-2">&#39;SIGINT&#39;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Closing server...&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">(); </span><span class="hl-9">// Close cache before server</span><br/><span class="hl-1">  </span><span class="hl-4">server</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-multiple-calls-are-safe">Example: Multiple calls are safe<a href="#example-multiple-calls-are-safe" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">(); </span><span class="hl-9">// First call closes connections</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">(); </span><span class="hl-9">// Second call returns immediately</span>
</code><button type="button">Copy</button></pre>

</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/stephen-shopopop/node-cache/blob/b8bbbce1d1b1db882a4ac86917d237c40b63daef/src/library/redis-cache-store.ts#L775">redis-cache-store.ts:775</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="delete"><span>delete</span><a href="#delete" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="delete-1"><span class="tsd-kind-call-signature">delete</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">key</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span><a href="#delete-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Deletes a cache entry and its associated metadata from Redis.</p>
<p>This method performs a complete cleanup by:</p>
<ol>
<li>Fetching the metadata to get the associated value UUID</li>
<li>Deleting both the metadata hash and the value string</li>
<li>Removing the entry from the local tracking cache (if enabled)</li>
</ol>
<p>The operation is atomic - either both keys are deleted or neither is.
If the metadata doesn't exist, the method returns silently without error.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">key</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The cache key to delete</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves when the deletion is complete</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-basic-deletion">Example: Basic deletion<a href="#example-basic-deletion" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;user:123&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;User cache entry deleted&#39;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-batch-deletion">Example: Batch deletion<a href="#example-batch-deletion" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">keysToDelete</span><span class="hl-1"> = [</span><span class="hl-2">&#39;user:1&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;user:2&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;user:3&#39;</span><span class="hl-1">];</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-7">Promise</span><span class="hl-1">.</span><span class="hl-0">all</span><span class="hl-1">(</span><span class="hl-4">keysToDelete</span><span class="hl-1">.</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-4">key</span><span class="hl-1">)));</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;All user entries deleted&#39;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-safe-deletion-no-error-if-key-doesnt-exist">Example: Safe deletion (no error if key doesn&#39;t exist)<a href="#example-safe-deletion-no-error-if-key-doesnt-exist" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-9">// This won&#39;t throw even if &#39;nonexistent:key&#39; doesn&#39;t exist</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;nonexistent:key&#39;</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/stephen-shopopop/node-cache/blob/b8bbbce1d1b1db882a4ac86917d237c40b63daef/src/library/redis-cache-store.ts#L653">redis-cache-store.ts:653</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="findbykey"><span>find<wbr/>By<wbr/>Key</span><a href="#findbykey" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="findbykey-1"><span class="tsd-kind-call-signature">findByKey</span><span class="tsd-signature-symbol">(</span><br/>    <span class="tsd-kind-parameter">key</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span><br/><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">undefined</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">metadata</span><span class="tsd-signature-symbol">:</span> <a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">value</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span><a href="#findbykey-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><code class="tsd-tag">Internal</code><div class="tsd-comment tsd-typography"><p>Retrieves a value and its associated metadata from Redis by the provided key.</p>
<p>This is the core lookup method that handles the Redis-level operations.
It performs the following steps:</p>
<ol>
<li>Fetch metadata hash using <code>HGETALL</code></li>
<li>If metadata exists, fetch the actual value using the embedded UUID</li>
<li>Handle cleanup of stale entries (metadata without corresponding values)</li>
<li>Parse and validate metadata JSON</li>
<li>Clean up corrupted entries and log errors appropriately</li>
</ol>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">key</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The key to look up in the cache</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">undefined</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">metadata</span><span class="tsd-signature-symbol">:</span> <a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">value</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to an object containing the value and its metadata, or <code>undefined</code> if the key is not found or an error occurs</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-error-scenarios-handled">Example: Error scenarios handled:<a href="#example-error-scenarios-handled" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-9">// Scenario 1: Metadata exists but value expired</span><br/><span class="hl-9">// Action: Delete stale metadata, return undefined</span><br/><br/><span class="hl-9">// Scenario 2: Metadata JSON is corrupted</span><br/><span class="hl-9">// Action: Delete both metadata and value, log error, return undefined</span><br/><br/><span class="hl-9">// Scenario 3: Redis connection error</span><br/><span class="hl-9">// Action: Call error callback, return undefined</span>
</code><button type="button">Copy</button></pre>

</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/stephen-shopopop/node-cache/blob/b8bbbce1d1b1db882a4ac86917d237c40b63daef/src/library/redis-cache-store.ts#L455">redis-cache-store.ts:455</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="get"><span>get</span><a href="#get" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="get-1"><span class="tsd-kind-call-signature">get</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">key</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">undefined</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">metadata</span><span class="tsd-signature-symbol">:</span> <a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">value</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span><a href="#get-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Retrieves a cached value and its associated metadata by key.</p>
<p>This method implements a two-tier lookup strategy:</p>
<ol>
<li><strong>Fast path</strong>: If local tracking is enabled and contains the key, return immediately</li>
<li><strong>Slow path</strong>: Query Redis for the entry, then populate the tracking cache if found</li>
</ol>
<p>The method handles various edge cases including:</p>
<ul>
<li>Missing or corrupted metadata</li>
<li>Expired values with lingering metadata</li>
<li>JSON parsing errors in metadata</li>
</ul>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">key</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The cache key to retrieve</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">undefined</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-symbol">{</span> <span class="tsd-kind-property">metadata</span><span class="tsd-signature-symbol">:</span> <a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol">;</span> <span class="tsd-kind-property">value</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">}</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves to an object containing the value and metadata if found, or <code>undefined</code> if the key does not exist or an error occurs</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-basic-retrieval">Example: Basic retrieval<a href="#example-basic-retrieval" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;user:123&#39;</span><span class="hl-1">);</span><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;User data:&#39;</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Metadata:&#39;</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">metadata</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-3">else</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;User not found in cache&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-type-safe-metadata-access">Example: Type-safe metadata access<a href="#example-type-safe-metadata-access" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-7">UserMetadata</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">lastUpdated</span><span class="hl-1">: </span><span class="hl-7">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">version</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">store</span><span class="hl-1"> = </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">RedisCacheStore</span><span class="hl-1">&lt;</span><span class="hl-7">UserMetadata</span><span class="hl-1">&gt;();</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;user:123&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">result</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-9">// TypeScript knows metadata has lastUpdated and version</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Last updated:&#39;</span><span class="hl-1">, </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">metadata</span><span class="hl-1">.</span><span class="hl-4">lastUpdated</span><span class="hl-1">));</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Version:&#39;</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">.</span><span class="hl-4">metadata</span><span class="hl-1">.</span><span class="hl-4">version</span><span class="hl-1">);</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/stephen-shopopop/node-cache/blob/b8bbbce1d1b1db882a4ac86917d237c40b63daef/src/library/redis-cache-store.ts#L408">redis-cache-store.ts:408</a></li></ul></aside></div></li></ul></section><section class="tsd-panel tsd-member"><h3 class="tsd-anchor-link" id="set"><span>set</span><a href="#set" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class=""><div class="tsd-signature tsd-anchor-link" id="set-1"><span class="tsd-kind-call-signature">set</span><span class="tsd-signature-symbol">(</span><br/>    <span class="tsd-kind-parameter">key</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">,</span><br/>    <span class="tsd-kind-parameter">value</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">Buffer</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">ArrayBufferLike</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">,</span><br/>    <span class="tsd-kind-parameter">metadata</span><span class="tsd-signature-symbol">?:</span> <a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol">,</span><br/>    <span class="tsd-kind-parameter">ttl</span><span class="tsd-signature-symbol">?:</span> <span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">,</span><br/><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span><a href="#set-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></div><div class="tsd-description"><div class="tsd-comment tsd-typography"><p>Stores a value in the Redis cache with associated metadata and an optional time-to-live (TTL).</p>
<p>This method performs atomic storage using Redis pipelines to ensure consistency.
The operation includes:</p>
<ol>
<li><strong>Validation</strong>: Checks value type, metadata object, TTL, and size constraints</li>
<li><strong>UUID Generation</strong>: Creates a unique identifier for value storage</li>
<li><strong>Atomic Storage</strong>: Uses Redis pipeline for atomic HSET + SET + 2x EXPIRE operations</li>
<li><strong>Size Enforcement</strong>: Prevents storage of entries exceeding <code>maxEntrySize</code></li>
</ol>
<h2 id="storage-schema" class="tsd-anchor-link">Storage Schema<a href="#storage-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code><span class="hl-10">metadata</span><span class="hl-1">:[</span><span class="hl-4">key</span><span class="hl-1">] → { </span><span class="hl-10">metadata</span><span class="hl-1">: </span><span class="hl-6">JSON</span><span class="hl-1">, </span><span class="hl-10">id</span><span class="hl-1">: </span><span class="hl-6">UUID</span><span class="hl-1"> }  [</span><span class="hl-6">TTL</span><span class="hl-1">: </span><span class="hl-4">ttl</span><span class="hl-1"> </span><span class="hl-4">seconds</span><span class="hl-1">]</span><br/><span class="hl-10">values</span><span class="hl-1">:[</span><span class="hl-6">UUID</span><span class="hl-1">]  → </span><span class="hl-4">value</span><span class="hl-1">                         [</span><span class="hl-6">TTL</span><span class="hl-1">: </span><span class="hl-4">ttl</span><span class="hl-1"> </span><span class="hl-4">seconds</span><span class="hl-1">]</span>
</code><button>Copy</button></pre>

</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">key</span>: <span class="tsd-signature-type">string</span></span><div class="tsd-comment tsd-typography"><p>The cache key under which the value will be stored</p>
</div></li><li><span><span class="tsd-kind-parameter">value</span>: <span class="tsd-signature-type">string</span> <span class="tsd-signature-symbol">|</span> <span class="tsd-signature-type">Buffer</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">ArrayBufferLike</span><span class="tsd-signature-symbol">&gt;</span></span><div class="tsd-comment tsd-typography"><p>The value to store; must be a string or Buffer</p>
</div></li><li><span><span class="tsd-kind-parameter">metadata</span>: <a class="tsd-signature-type tsd-kind-type-parameter" href="#constructorrediscachestoremetadata">Metadata</a><span class="tsd-signature-symbol"> = ...</span></span><div class="tsd-comment tsd-typography"><p>Metadata object to associate with the cache entry. Defaults to empty object if not provided</p>
</div></li><li><span><code class="tsd-tag">Optional</code><span class="tsd-kind-parameter">ttl</span>: <span class="tsd-signature-type">number</span></span><div class="tsd-comment tsd-typography"><p>Time-to-live in seconds; must be a non-negative integer. If not provided, entries will not expire</p>
</div></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><p>A promise that resolves when the value and metadata have been stored successfully</p>
<div class="tsd-comment tsd-typography"><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-3">Throws<a href="#throws-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If the value is not a string or Buffer</p>
</div><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-4">Throws<a href="#throws-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If the metadata is not an object or is null</p>
</div><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-5">Throws<a href="#throws-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If the ttl is not a non-negative integer</p>
</div><div class="tsd-tag-throws"><h4 class="tsd-anchor-link" id="throws-6">Throws<a href="#throws-6" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>If the entry size exceeds the maximum allowed size</p>
</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-basic-storage">Example: Basic storage<a href="#example-basic-storage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;user:123&#39;</span><span class="hl-1">, </span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-4">userData</span><span class="hl-1">), {</span><br/><span class="hl-1">  </span><span class="hl-4">userId:</span><span class="hl-1"> </span><span class="hl-2">&#39;123&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">lastUpdated:</span><span class="hl-1"> </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">()</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-with-ttl">Example: With TTL<a href="#example-with-ttl" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;session:abc&#39;</span><span class="hl-1">, </span><span class="hl-4">sessionData</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">sessionId:</span><span class="hl-1"> </span><span class="hl-2">&#39;abc&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">createdAt:</span><span class="hl-1"> </span><span class="hl-4">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">()</span><br/><span class="hl-1">}, </span><span class="hl-8">3600</span><span class="hl-1">); </span><span class="hl-9">// Expires in 1 hour</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-buffer-storage">Example: Buffer storage<a href="#example-buffer-storage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">imageBuffer</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">fs</span><span class="hl-1">.</span><span class="hl-0">readFile</span><span class="hl-1">(</span><span class="hl-2">&#39;image.jpg&#39;</span><span class="hl-1">);</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;image:123&#39;</span><span class="hl-1">, </span><span class="hl-4">imageBuffer</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-4">filename:</span><span class="hl-1"> </span><span class="hl-2">&#39;image.jpg&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">mimeType:</span><span class="hl-1"> </span><span class="hl-2">&#39;image/jpeg&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">size:</span><span class="hl-1"> </span><span class="hl-4">imageBuffer</span><span class="hl-1">.</span><span class="hl-4">length</span><br/><span class="hl-1">}, </span><span class="hl-8">86400</span><span class="hl-1">); </span><span class="hl-9">// Expires in 24 hours</span>
</code><button type="button">Copy</button></pre>

</div><div class="tsd-tag-example"><h4 class="tsd-anchor-link" id="example-error-handling">Example: Error handling<a href="#example-error-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><pre><code class="typescript"><span class="hl-3">try</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;large-file&#39;</span><span class="hl-1">, </span><span class="hl-4">hugeBuffer</span><span class="hl-1">, {}, </span><span class="hl-8">3600</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-3">catch</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">.</span><span class="hl-0">includes</span><span class="hl-1">(</span><span class="hl-2">&#39;maxEntrySize&#39;</span><span class="hl-1">)) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;File too large for cache&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</div></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/stephen-shopopop/node-cache/blob/b8bbbce1d1b1db882a4ac86917d237c40b63daef/src/library/redis-cache-store.ts#L575">redis-cache-store.ts:575</a></li></ul></aside></div></li></ul></section></section></details></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#key-features"><span>Key <wbr/>Features</span></a><a href="#architecture-details"><span>Architecture <wbr/>Details</span></a><a href="#performance-characteristics"><span>Performance <wbr/>Characteristics</span></a><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Constructors"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Constructors</summary><div><a href="#constructor"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Constructor"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a></div></details><details open class="tsd-accordion tsd-page-navigation-section"><summary class="tsd-accordion-summary" data-key="section-Methods"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Methods</summary><div><a href="#close"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>close</span></a><a href="#delete"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>delete</span></a><a href="#findbykey"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>find<wbr/>By<wbr/>Key</span></a><a href="#get"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get</span></a><a href="#set"><svg class="tsd-kind-icon" viewBox="0 0 24 24" aria-label="Method"><use href="../assets/icons.svg#icon-2048"></use></svg><span>set</span></a><ul><li><a href="#storage-schema"><span>Storage <wbr/>Schema</span></a></li></ul></div></details></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">@stephen-shopopop/cache</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
